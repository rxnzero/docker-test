<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="BatCountMonitor">

	<statement id="selectList" resultClass="java.util.HashMap">
		SELECT NVL(SUM(CASE WHEN T2.sndStatusCd IS NOT NULL THEN 1 ELSE 0 END)                            ,0) AS sndStatusCnt0,
	           NVL(SUM(CASE WHEN T2.rcvStatusCd IS NOT NULL THEN 1 ELSE 0 END)                            ,0) AS rcvStatusCnt0,
	           NVL(SUM(CASE WHEN T2.sndStatusCd='C' THEN 1 ELSE 0 END)                                    ,0) AS sndStatusCnt1,
	           NVL(SUM(CASE WHEN T2.sndStatusCd NOT IN ('C','S') THEN 1 ELSE 0 END)                       ,0) AS sndStatusCnt2,
	           NVL(SUM(CASE WHEN T2.rcvStatusCd='C' THEN 1 ELSE 0 END)                                    ,0) AS rcvStatusCnt1,
	           NVL(SUM(CASE WHEN T2.rcvStatusCd NOT IN ('C','S') AND t2.sndStatusCd='C' THEN 1 ELSE 0 END),0) AS rcvStatusCnt2,
	           NVL(SUM(CASE WHEN T2.sndStatusCd='S' THEN 1 ELSE 0 END)                                    ,0) AS sndStatusCnt3,
	           NVL(SUM(CASE WHEN T2.rcvStatusCd='S' THEN 1 ELSE 0 END)                                    ,0) AS rcvStatusCnt3
		FROM ( SELECT NVL((SELECT MAX(transStatusCd) FROM $schemaId$.TSEAIES03 WHERE BjobDmndMsgID=a.BjobDmndMsgID AND sndRcvKind='1' ),
	                  NVL((SELECT MAX(transStatusCd) FROM $schemaId$.TSEAIES04 WHERE BjobDmndMsgID=a.BjobDmndMsgID AND sndRcvKind='1' ),'F')) AS sndStatusCd,
	                  NVL((SELECT MAX(transStatusCd) FROM $schemaId$.TSEAIES03 WHERE BjobDmndMsgID=a.BjobDmndMsgID AND sndRcvKind='2' ),
	                  NVL((SELECT MAX(transStatusCd) FROM $schemaId$.TSEAIES04 WHERE BjobDmndMsgID=a.BjobDmndMsgID AND sndRcvKind='2' ),'F')) AS rcvStatusCd
	           FROM   $schemaId$.TSEAIES01 A
	           WHERE A.msgRegDate BETWEEN #searchStartDate# AND #searchEndDate# || '9'
	         ) T2
	</statement>	

</sqlMap>
