<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="EaiBzwkDstcdMonthly">
  
  <statement id="selectListCount" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT COUNT(*) AS "TOTALCOUNT"
        	 , SUM(MNTRSMTNOITM1)	AS "MNTRSMTNOITM1_SUM"
             , SUM(MNERRNOITM1)		AS "MNERRNOITM1_SUM"
			 , SUM(MNTRSMTNOITM2)	AS "MNTRSMTNOITM2_SUM"
             , SUM(MNERRNOITM2)		AS "MNERRNOITM2_SUM"
			 , SUM(MNTRSMTNOITM3)	AS "MNTRSMTNOITM3_SUM"
             , SUM(MNERRNOITM3)		AS "MNERRNOITM3_SUM"
			 , SUM(MNTRSMTNOITM4)	AS "MNTRSMTNOITM4_SUM"
             , SUM(MNERRNOITM4)		AS "MNERRNOITM4_SUM"
			 , SUM(MNTRSMTNOITM5)	AS "MNTRSMTNOITM5_SUM"
             , SUM(MNERRNOITM5)		AS "MNERRNOITM5_SUM"
			 , SUM(MNTRSMTNOITM6)	AS "MNTRSMTNOITM6_SUM"
             , SUM(MNERRNOITM6)		AS "MNERRNOITM6_SUM"
			 , SUM(MNTRSMTNOITM7)	AS "MNTRSMTNOITM7_SUM"
             , SUM(MNERRNOITM7)		AS "MNERRNOITM7_SUM"
			 , SUM(MNTRSMTNOITM8)	AS "MNTRSMTNOITM8_SUM"
             , SUM(MNERRNOITM8)		AS "MNERRNOITM8_SUM"
			 , SUM(MNTRSMTNOITM9)	AS "MNTRSMTNOITM9_SUM"
             , SUM(MNERRNOITM9)		AS "MNERRNOITM9_SUM"
			 , SUM(MNTRSMTNOITM10)	AS "MNTRSMTNOITM10_SUM"
             , SUM(MNERRNOITM10)	AS "MNERRNOITM10_SUM"
			 , SUM(MNTRSMTNOITM11)	AS "MNTRSMTNOITM11_SUM"
             , SUM(MNERRNOITM11)	AS "MNERRNOITM11_SUM"
			 , SUM(MNTRSMTNOITM12)	AS "MNTRSMTNOITM12_SUM"
             , SUM(MNERRNOITM12)	AS "MNERRNOITM12_SUM"
          FROM (
		        SELECT SUM(ST04.S1MNTRSMTNOITM)  AS  MNTRSMTNOITM1,  SUM(ST04.S1MNERRNOITM)  AS MNERRNOITM1,
					   SUM(ST04.S2MNTRSMTNOITM)  AS  MNTRSMTNOITM2,  SUM(ST04.S2MNERRNOITM)  AS MNERRNOITM2,
					   SUM(ST04.S3MNTRSMTNOITM)  AS  MNTRSMTNOITM3,  SUM(ST04.S3MNERRNOITM)  AS MNERRNOITM3,
					   SUM(ST04.S4MNTRSMTNOITM)  AS  MNTRSMTNOITM4,  SUM(ST04.S4MNERRNOITM)  AS MNERRNOITM4,
					   SUM(ST04.S5MNTRSMTNOITM)  AS  MNTRSMTNOITM5,  SUM(ST04.S5MNERRNOITM)  AS MNERRNOITM5,
					   SUM(ST04.S6MNTRSMTNOITM)  AS  MNTRSMTNOITM6,  SUM(ST04.S6MNERRNOITM)  AS MNERRNOITM6,
					   SUM(ST04.S7MNTRSMTNOITM)  AS  MNTRSMTNOITM7,  SUM(ST04.S7MNERRNOITM)  AS MNERRNOITM7,
					   SUM(ST04.S8MNTRSMTNOITM)  AS  MNTRSMTNOITM8,  SUM(ST04.S8MNERRNOITM)  AS MNERRNOITM8,
					   SUM(ST04.S9MNTRSMTNOITM)  AS  MNTRSMTNOITM9,  SUM(ST04.S9MNERRNOITM)  AS MNERRNOITM9,
					   SUM(ST04.S10MNTRSMTNOITM) AS  MNTRSMTNOITM10, SUM(ST04.S10MNERRNOITM) AS MNERRNOITM10,
					   SUM(ST04.S11MNTRSMTNOITM) AS  MNTRSMTNOITM11, SUM(ST04.S11MNERRNOITM) AS MNERRNOITM11,
					   SUM(ST04.S12MNTRSMTNOITM) AS  MNTRSMTNOITM12, SUM(ST04.S12MNERRNOITM) AS MNERRNOITM12
				  FROM $schemaId$.TSEAIST04 ST04
				  LEFT OUTER JOIN $schemaId$.TSEAICM01 CM01
			           ON TRIM(ST04.EAIBZWKDSTCD) = CM01.EAIBZWKDSTCD
				 WHERE TRIM(ST04.STATCYM) BETWEEN #searchStart# AND #searchEnd#
				<isNotEmpty prepend="AND" property="searchEaiBzwkDstcd">
					( TRIM(ST04.EAIBZWKDSTCD) LIKE CONCAT( '%',CONCAT( UPPER(#searchEaiBzwkDstcd#) , '%') ) OR
					  CM01.BZWKDSTICNAME LIKE CONCAT( '%',CONCAT( UPPER(#searchEaiBzwkDstcd#) , '%') )  )
				</isNotEmpty>
				 GROUP BY ST04.EAIBZWKDSTCD
          	   ) A
  </statement>
  
  <statement id="selectByEaiBzwkDstcdMonthly" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        SELECT ST04.EAIBZWKDSTCD AS "EAIBZWKDSTCD",
			   SUM(ST04.S1MNTRSMTNOITM)  AS "MNTRSMTNOITM1",  SUM(ST04.S1MNERRNOITM)  AS "MNERRNOITM1",
			   SUM(ST04.S2MNTRSMTNOITM)  AS "MNTRSMTNOITM2",  SUM(ST04.S2MNERRNOITM)  AS "MNERRNOITM2",
			   SUM(ST04.S3MNTRSMTNOITM)  AS "MNTRSMTNOITM3",  SUM(ST04.S3MNERRNOITM)  AS "MNERRNOITM3",
			   SUM(ST04.S4MNTRSMTNOITM)  AS "MNTRSMTNOITM4",  SUM(ST04.S4MNERRNOITM)  AS "MNERRNOITM4",
			   SUM(ST04.S5MNTRSMTNOITM)  AS "MNTRSMTNOITM5",  SUM(ST04.S5MNERRNOITM)  AS "MNERRNOITM5",
			   SUM(ST04.S6MNTRSMTNOITM)  AS "MNTRSMTNOITM6",  SUM(ST04.S6MNERRNOITM)  AS "MNERRNOITM6",
			   SUM(ST04.S7MNTRSMTNOITM)  AS "MNTRSMTNOITM7",  SUM(ST04.S7MNERRNOITM)  AS "MNERRNOITM7",
			   SUM(ST04.S8MNTRSMTNOITM)  AS "MNTRSMTNOITM8",  SUM(ST04.S8MNERRNOITM)  AS "MNERRNOITM8",
			   SUM(ST04.S9MNTRSMTNOITM)  AS "MNTRSMTNOITM9",  SUM(ST04.S9MNERRNOITM)  AS "MNERRNOITM9",
			   SUM(ST04.S10MNTRSMTNOITM) AS "MNTRSMTNOITM10", SUM(ST04.S10MNERRNOITM) AS "MNERRNOITM10",
			   SUM(ST04.S11MNTRSMTNOITM) AS "MNTRSMTNOITM11", SUM(ST04.S11MNERRNOITM) AS "MNERRNOITM11",
			   SUM(ST04.S12MNTRSMTNOITM) AS "MNTRSMTNOITM12", SUM(ST04.S12MNERRNOITM) AS "MNERRNOITM12"
		  FROM $schemaId$.TSEAIST04 ST04
		  LEFT OUTER JOIN $schemaId$.TSEAICM01 CM01
	           ON TRIM(ST04.EAIBZWKDSTCD) = CM01.EAIBZWKDSTCD
		 WHERE TRIM(ST04.STATCYM) BETWEEN #searchStart# AND #searchEnd#
		<isNotEmpty prepend="AND" property="searchEaiBzwkDstcd">
			( TRIM(ST04.EAIBZWKDSTCD) LIKE CONCAT( '%',CONCAT( UPPER(#searchEaiBzwkDstcd#) , '%') )  OR
			  CM01.BZWKDSTICNAME LIKE CONCAT( '%',CONCAT( UPPER(#searchEaiBzwkDstcd#) , '%') )  )
		</isNotEmpty>
		 GROUP BY ST04.EAIBZWKDSTCD
		 ORDER BY ST04.EAIBZWKDSTCD
  </statement>
</sqlMap>
