<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="TransactionHourly">
  
  <statement id="findByTransactionHourly" parameterClass="java.util.HashMap" resultClass="com.eactive.eai.rms.onl.statistics.etc.vo.TransactionHourlyVO">		
          SELECT STATCYMD as "STATCYMD",
				         SUM(S1HHTRSMTNOITM)  AS "HHTRSMTNOITM1",  SUM(S1HHERRNOITM) AS "HHERRNOITM1",
				         SUM(S2HHTRSMTNOITM)  AS "HHTRSMTNOITM2",  SUM(S2HHERRNOITM) AS "HHERRNOITM2",
				         SUM(S3HHTRSMTNOITM)  AS "HHTRSMTNOITM3",  SUM(S3HHERRNOITM) AS "HHERRNOITM3",
				         SUM(S4HHTRSMTNOITM)  AS "HHTRSMTNOITM4",  SUM(S4HHERRNOITM) AS "HHERRNOITM4",
				         SUM(S5HHTRSMTNOITM)  AS "HHTRSMTNOITM5",  SUM(S5HHERRNOITM) AS "HHERRNOITM5",
				         SUM(S6HHTRSMTNOITM)  AS "HHTRSMTNOITM6",  SUM(S6HHERRNOITM) AS "HHERRNOITM6",
				         SUM(S7HHTRSMTNOITM)  AS "HHTRSMTNOITM7",  SUM(S7HHERRNOITM) AS "HHERRNOITM7",
				         SUM(S8HHTRSMTNOITM)  AS "HHTRSMTNOITM8",  SUM(S8HHERRNOITM) AS "HHERRNOITM8",
				         SUM(S9HHTRSMTNOITM)  AS "HHTRSMTNOITM9",  SUM(S9HHERRNOITM) AS "HHERRNOITM9",
				         SUM(S10HHTRSMTNOITM) AS "HHTRSMTNOITM10", SUM(S10HHERRNOITM) AS "HHERRNOITM10",
				         SUM(S11HHTRSMTNOITM) AS "HHTRSMTNOITM11", SUM(S11HHERRNOITM) AS "HHERRNOITM11",
				         SUM(S12HHTRSMTNOITM) AS "HHTRSMTNOITM12", SUM(S12HHERRNOITM) AS "HHERRNOITM12",
				         SUM(S13HHTRSMTNOITM) AS "HHTRSMTNOITM13", SUM(S13HHERRNOITM) AS "HHERRNOITM13",
				         SUM(S14HHTRSMTNOITM) AS "HHTRSMTNOITM14", SUM(S14HHERRNOITM) AS "HHERRNOITM14",
				         SUM(S15HHTRSMTNOITM) AS "HHTRSMTNOITM15", SUM(S15HHERRNOITM) AS "HHERRNOITM15",
				         SUM(S16HHTRSMTNOITM) AS "HHTRSMTNOITM16", SUM(S16HHERRNOITM) AS "HHERRNOITM16",
				         SUM(S17HHTRSMTNOITM) AS "HHTRSMTNOITM17", SUM(S17HHERRNOITM) AS "HHERRNOITM17",
				         SUM(S18HHTRSMTNOITM) AS "HHTRSMTNOITM18", SUM(S18HHERRNOITM) AS "HHERRNOITM18",
				         SUM(S19HHTRSMTNOITM) AS "HHTRSMTNOITM19", SUM(S19HHERRNOITM) AS "HHERRNOITM19",
				         SUM(S20HHTRSMTNOITM) AS "HHTRSMTNOITM20", SUM(S20HHERRNOITM) AS "HHERRNOITM20",
				         SUM(S21HHTRSMTNOITM) AS "HHTRSMTNOITM21", SUM(S21HHERRNOITM) AS "HHERRNOITM21",
				         SUM(S22HHTRSMTNOITM) AS "HHTRSMTNOITM22", SUM(S22HHERRNOITM) AS "HHERRNOITM22",
				         SUM(S23HHTRSMTNOITM) AS "HHTRSMTNOITM23", SUM(S23HHERRNOITM) AS "HHERRNOITM23",
				         SUM(S0HHTRSMTNOITM)  AS "HHTRSMTNOITM0",  SUM(S0HHERRNOITM)  AS "HHERRNOITM0"
            FROM $schemaId$.TSEAIST02                                                  
					<isNotEmpty prepend="WHERE" property="startDate"> 
					       STATCYMD BETWEEN #startDate#||'01' AND 
					       TO_CHAR((date_trunc('MONTH', to_date(#startDate#, 'YYYYMMDD')) + INTERVAL '1 MONTH - 1 day'), 'YYYYMMDD')					       
					</isNotEmpty>
	        GROUP BY STATCYMD
  </statement>
</sqlMap>
