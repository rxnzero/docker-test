<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="EaiBzwkDstcdCompareMonthly">
  
  <statement id="findByTransactionEaiBzwkDstcdMonthly" parameterClass="java.util.HashMap" resultClass="com.eactive.eai.rms.onl.statistics.eaibzwkdstcd.vo.EaiBzwkDstcdCompareMonthlyVO">
		SELECT A.EAIBZWKDSTCD AS "EAIBZWKDSTCD",
					 COALESCE(A.$thisMonthProcColumnName$, 0) AS "THISMONTHPROCCOLUMNNAME",
					 COALESCE(B.$lastMonthProcColumnName$, 0) AS "LASTMONTHPROCCOLUMNNAME"
			FROM (
			SELECT EAIBZWKDSTCD,
			    SUM($thisMonthProcColumnName$) AS $thisMonthProcColumnName$
			FROM $schemaId$.TSEAIST04
			WHERE STATCYM  BETWEEN #thisYear# AND #thisYear#
			GROUP BY EAIBZWKDSTCD
			) A
			LEFT OUTER JOIN
			(
			SELECT EAIBZWKDSTCD,
			SUM($lastMonthProcColumnName$) AS $lastMonthProcColumnName$
			FROM $schemaId$.TSEAIST04
			WHERE STATCYM BETWEEN #lastYear# AND #lastYear#
			GROUP BY EAIBZWKDSTCD
			) B
			ON  A.EAIBZWKDSTCD= B.EAIBZWKDSTCD
  </statement>
</sqlMap>
